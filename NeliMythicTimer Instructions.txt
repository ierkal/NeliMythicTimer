Task: Create a World of Warcraft Addon named "NeliMythicTimer" for the Midnight expansion (compatible with 12.0.1+ API).

Core Objective: Build a Mythic Plus (M+) HUD that replaces/augments the default objective tracker with a high-fidelity, transparent vertical panel as per the provided design specifications.



1. Architectural Constraints (Strict)

Language: Lua (World of Warcraft API).

API Compliance: Ensure compatibility with 12.0.1 restricted APIs.

2. UI Specifications

Layout: This panel will be replace the blizzard's own mythic plus timer UI. When mythic plus run starts, Blizzard's objective tracker, quests panel should be hidden and this addon will be shown there instead. Even run completes this will be stay there with the last data. 

Timers will stop after the run is completed.

Background: 60% transparent black (0, 0, 0, 0.6).

Elements (Top to Bottom):

Dungeon Name: Bold, large font.

Timer Row: (+Level) CurrentTime / TotalTime.

Death Counter: Deaths (-Seconds Penalty). Note: If Key Level >= 12, penalty is -15s per death if below 12, it is -5s per death.

Affix List: Horizontal list. Use short names: "Ascendant", "Voidbound", "Pulsar", "Devour".

Main Progress Bar: A bar representing total time. (black background, filling with purple)

Place three vertical yellow tick marks representing the +2 and +3 thresholds. (we will put timer text for each vertical yellow marks, as aligned to right of their own.)

Enemy Progress Bar: * Primary Bar: Current total percentage. (black background, purple filling, text white)

Overlay/Ghost Bar: Percentage that will be added by current mobs in combat. 

Text: Count/Total - % (Current Pull %). (Current pull text can be green, for example: +20 (+3.20%)

Boss List: List of boss names.

Active: White text.

Defeated: Green text with the timestamp of the kill (e.g., [12:40] Boss Name).


Layout Preview:

Dungeon Name(with small text, aligned to right.)
(+key level) Timer / Max Time to Complete(aligned to right)
0 Deaths(-0s)(aligned to right.)
Key Affixes as grayed(aligned to right)
Timer progress bar
Enemy count progress bar
Boss List

Progress bar texts are aligned to center inside of progress bars.


3. Data & Logic Constants

Dungeon Table (TWW Season 3 Test Data):

| Dungeon Name | +1 (100%) | +2 (80%) | +3 (60%) |

| :--- | :--- | :--- | :--- |

| Eco-Dome Al'dani | 31:00 | 24:48 | 18:36 |

| Ara-Kara, City of Echoes | 30:00 | 24:00 | 18:00 |

| The Dawnbreaker | 31:00 | 24:48 | 18:36 |

| Priory of the Sacred Flame | 32:30 | 26:00 | 19:30 |

| Operation: Floodgate | 33:00 | 26:24 | 19:48 |

| Halls of Atonement | 31:00 | 24:28 | 18:36 |

| Tazavesh: Streets of Wonder | 39:00 | 31:12 | 23:24 |

| Tazavesh: So'leah's Gambit | 30:00 | 24:00 | 18:00 |

Affix Logic:



Level 4: Rotate between Ascendant, Voidbound, Pulsar, Devour.

Level 7 & 10: Fortified / Tyrannical.

Level 10: Fortified and Tyrannical being together in key.

Level 12: Remove Bargains, apply Xal'atath's Guile (15s death penalty).

4. Required Modules to Generate

EventObserver.lua: A robust event handler to catch CHALLENGE_MODE_START, COMBAT_LOG_EVENT_UNFILTERED (for deaths/mob kills), and SCENARIO_CRITERIA_UPDATE.

DungeonDataManager.lua: Logic to fetch current dungeon info, timers, and affix states.

TimerEngine.lua: Handles the countdown/up logic and threshold calculations (+2, +3).

UIManager.lua: Uses the WoW FrameXML to construct the UI elements, handling the progress bar updates and boss text color changes.

DeathTracker.lua: Tracks party deaths and applies the 15s calculation for Level 12+ keys.